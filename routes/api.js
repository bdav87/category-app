const express = require('express');
const router = express.Router();
const BigCommerce = require('node-bigcommerce');
const mysql = require('mysql');
const bcAuth = require('../lib/bc_auth');

// TEST ROUTE to ensure auth library works
router.get('/', (req,res) => {
    bcAuth().then((data) => res.send(data))
})

// TEST ROUTE to generate a category
router.get('/single', (req,res) => {
    bcAuth()
    .then(data => createSampleCategory(data))
    .catch(error => res.send(`Error authenticating: ${error}`))

    function createSampleCategory(bc_api) {
        let category = {
            parent_id: 0,
            name: `Sample Category ${Math.round(Math.random() * 1000000)}`,
            description: 'A sample category generated by the app'
        }
        bc_api.post('/catalog/categories', category)
        .then(data => res.send(data))
        .catch(err => res.send(`There was an error: ${err}.}`))
    }
    
})

module.exports = router;